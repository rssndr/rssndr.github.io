<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Writing - Andrea Rossetti</title>
        <link rel="stylesheet" href="../style.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
        <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script> <!-- Not needed for fetching, but if you want to parse MD structure -->
    </head>
    <body>
        <nav id="sidebar-placeholder" class="sidebar"></nav>
        <button id="theme-toggle" class="theme-toggle"><i class="fas fa-moon"></i></button>
        <main>
            <div class="main-content">
                <h1>Writing</h1>
                <p>Explore my thoughts on technology, politics, and society.</p>

                <ul class="item-list" id="posts-list">
                    <!-- JS generates list -->
                </ul>
            </div>

            <footer class="site-footer">
                <p>Built with HTML, CSS & JS</p>
                <p>© 2025 Andrea Rossetti</p>
            </footer>
       </main>

        <button id="back-to-top">↑</button>

        <script src="../js/theme-toggle.js"></script>
        <script src="../js/back-to-top.js"></script>
        <script src="../js/sidebar.js"></script>

        <script>
            const postIds = ['post1', 'post2', 'post3']; // to be updated

            const listContainer = document.getElementById('posts-list');

            postIds.forEach(id => {
                fetch(`../posts/${id}.md`)
                    .then(response => response.text())
                    .then(md => {
                        // Extract title from first # line
                        const titleMatch = md.match(/^# (.*)/);
                        const title = titleMatch ? titleMatch[1].trim() : 'Untitled';

                        // Extract subtitle from first paragraph after title
                        const subtitleMatch = md.match(/\n\n(.*?)\n/);
                        const subtitle = subtitleMatch ? subtitleMatch[1].trim() : 'No description available';

                        // Create list item
                        const li = document.createElement('li');
                        li.innerHTML = `
                            <a href="../posts/post.html?id=${id}">
                                <span class="item-title">${title}</span>
                                <span class="item-subtitle">${subtitle}</span>
                                <span class="item-arrow">→</span>
                            </a>
                        `;
                        listContainer.appendChild(li);
                    })
                    .catch(error => console.error(`Error loading ${id}.md:`, error));
            });
        </script>

        <script data-goatcounter="https://andrearossetti.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
    </body>
</html>

